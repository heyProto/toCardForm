!function(r){function t(o){if(e[o])return e[o].exports;var a=e[o]={exports:{},id:o,loaded:!1};return r[o].call(a.exports,a,a.exports,t),a.loaded=!0,a.exports}var e={};return t.m=r,t.c=e,t.p="",t(0)}([function(r,t,e){"use strict";function o(r){return r&&r.__esModule?r:{default:r}}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(r){return typeof r}:function(r){return r&&"function"==typeof Symbol&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},n=e(1),i=o(n),d=e(2),s=o(d),c=e(3),l=o(c),u=e(5),p=o(u);"object"===a(window.viewCast)?s.default.render(i.default.createElement(p.default,null),document.getElementById("root")):s.default.render(i.default.createElement(l.default,null),document.getElementById("root"))},function(r,t){r.exports=React},function(r,t){r.exports=ReactDOM},function(r,t,e){"use strict";function o(r){return r&&r.__esModule?r:{default:r}}function a(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function n(r,t){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?r:t}function i(r,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(r,t):r.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var d=function(){function r(r,t){for(var e=0;e<t.length;e++){var o=t[e];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(r,o.key,o)}}return function(t,e,o){return e&&r(t.prototype,e),o&&r(t,o),t}}(),s=e(1),c=o(s),l=e(4),u=o(l),p=function(r){function t(r){a(this,t);var e=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,r));return e.state={currentStep:1,currentCard:null,cards:[],cardData:[]},e.handleSelectCardClick=e.handleSelectCardClick.bind(e),e.handleSelectConfirmCard=e.handleSelectConfirmCard.bind(e),e.handlePublishClick=e.handlePublishClick.bind(e),e}return i(t,r),d(t,[{key:"componentDidMount",value:function(){var r=this,t=u.default.create({baseURL:window.baseURL}),e={headers:{"Access-Token":window.accessToken,"Content-Type":"application/json"}};t.get(window.baseURL+"/accounts/"+window.accountSlug+"/folders/"+window.folderSlug+"/template_cards/",e,{timeout:5e3}).then(function(t){r.setState({cards:t.data.template_cards})})}},{key:"handleSelectCardClick",value:function(r){var t=this,e=r.target.closest(".single-element"),o=u.default.create({baseURL:window.baseURL}),a={headers:{"Access-Token":window.accessToken,"Content-Type":"application/json"}};o.get(window.baseURL+"/accounts/"+window.accountSlug+"/folders/"+window.folderSlug+"/template_cards/"+e.id,a,{timeout:5e3}).then(function(r){var e=r.data.template_card,o={currentCard:e,accountID:e.account_id,APIName:e.git_repo_name,templateDatumID:e.template_datum_id,templateCardID:e.id};t.setState(o),t.handleSelectConfirmCard(o.currentCard)})}},{key:"handleSelectConfirmCard",value:function(r){var t=this,e=document.createElement("script"),o=void 0;this.setState({currentStep:2}),document.body.appendChild(e),e.onreadystatechange=e.onload=function(){if(!o){t.renderCard(r);var e=document.getElementById("protograph_image_bank_button");e&&(e.style.display="block")}o=!0},e.setAttribute("src",r.files.edit_file_js);var a=document.createElement("link");a.rel="stylesheet",a.href=r.files.css,document.head.appendChild(a)}},{key:"handlePublishClick",value:function(){var r=u.default.create({baseURL:window.baseURL}),t=this.state.protoGraphInstance.getData();return r.defaults.headers["Access-Token"]=window.accessToken,r.defaults.headers["Content-Type"]="application/json",r.post(window.baseURL+"/accounts/"+window.accountSlug+"/folders/"+window.folderSlug+"/datacasts",{datacast:t.dataJSON,view_cast:{account_id:this.state.accountID,template_datum_id:this.state.templateDatumID,name:t.name,template_card_id:this.state.templateCardID,seo_blockquote:"function"==typeof this.state.protoGraphInstance.renderSEO?this.state.protoGraphInstance.renderSEO():"",optionalConfigJSON:JSON.stringify(t.optionalConfigJSON)}}).then(function(r){window.location.href=r.data.redirect_path}).catch(function(r){"undefined"!=typeof _errs&&_errs.push(r);var t=r.response.data.error_message;t?showAllValidationErrors(t):generate_notify({text:r.response.statusText,notify:"error"})})}},{key:"getProtoInstance",value:function(r){switch(r){case"ProtoGraph.Card.toSocial":return new ProtoGraph.Card.toSocial;case"ProtoGraph.Card.toExplain":return new ProtoGraph.Card.toExplain;case"ProtoGraph.Card.toQuiz":return new ProtoGraph.Card.toQuiz;case"ProtoGraph.Card.toReportViolence":return new ProtoGraph.Card.toReportViolence;case"ProtoGraph.Card.toLink":return new ProtoGraph.Card.toLink;case"ProtoGraph.Card.toTimeline":return new ProtoGraph.Card.toTimeline;case"ProtoGraph.Card.toAudioPhoto":return new ProtoGraph.Card.toAudioPhoto;case"ProtoGraph.Card.toReportJournalistKilling":return new ProtoGraph.Card.toReportJournalistKilling;case"ProtoGraph.Card.toDistrictProfile":return new ProtoGraph.Card.toDistrictProfile;case"ProtoGraph.Card.toRainfall":return new ProtoGraph.Card.toRainfall;case"ProtoGraph.Card.toWaterExploitation":return new ProtoGraph.Card.toWaterExploitation;case"ProtoGraph.Card.toLandUse":return new ProtoGraph.Card.toLandUse;case"ProtoGraph.Card.toWell":return new ProtoGraph.Card.toWell;case"ProtoGraph.Card.toPoliticalLeadership":return new ProtoGraph.Card.toPoliticalLeadership;case"ProtoGraph.Card.toMoveToANewCity":return new ProtoGraph.Card.toMoveToANewCity;case"ProtoGraph.Card.toCluster":return new ProtoGraph.Card.toCluster;case"ProtoGraph.Card.toQuestion":return new ProtoGraph.Card.toQuestion;case"ProtoGraph.Card.toCompanyProfile":return new ProtoGraph.Card.toCompanyProfile;case"ProtoGraph.Card.toStory":return new ProtoGraph.Card.toStory;case"ProtoGraph.Card.toMedia":return new ProtoGraph.Card.toMedia;case"ProtoGraph.Card.WaterExploitation":return new ProtoGraph.Card.WaterExploitation;case"ProtoGraph.Card.toGrid":return new ProtoGraph.Card.toGrid;case"ProtoGraph.Card.toSurveyScores":return new ProtoGraph.Card.toSurveyScores;case"ProtoGraph.Card.toStinkCoverVizCard":return new ProtoGraph.Card.toStinkCoverVizCard;case"ProtoGraph.Card.ComposeCard":return new ProtoGraph.Card.ComposeCard;case"ProtoGraph.Card.toImage":return new ProtoGraph.Card.toImage;case"ProtoGraph.Card.VideoYoutube":return new ProtoGraph.Card.toVideoYoutube;case"ProtoGraph.Card.toVideoJWPlayer":return new ProtoGraph.Card.toVideoJWPlayer;case"ProtoGraph.Card.toDataIRBFGrid":return new ProtoGraph.Card.toDataIRBFGrid;case"ProtoGraph.Card.toDataIRBFTooltip":return new ProtoGraph.Card.toDataIRBFTooltip;case"ProtoGraph.Card.toDataRatingWithDrillDown":return new ProtoGraph.Card.toDataRatingWithDrillDown;case"ProtoGraph.Card.toProfile":return new ProtoGraph.Card.toProfile;case"ProtoGraph.Card.toOrganCoverVizCard":return new ProtoGraph.Card.toOrganCoverVizCard;case"ProtoGraph.Card.toEducationDistrictMap":return new ProtoGraph.Card.toEducationDistrictMap;case"ProtoGraph.Card.HTMLCard":return new ProtoGraph.Card.HTMLCard;case"ProtoGraph.Card.toBio":return new ProtoGraph.Card.toBio;case"ProtoGraph.Card.toCEEWHero":return new ProtoGraph.Card.toCEEWHero;case"ProtoGraph.Card.toCEEWHeroFlow1":return new ProtoGraph.Card.toCEEWHeroFlow1;case"ProtoGraph.Card.toCEEWHeroFlow2":return new ProtoGraph.Card.toCEEWHeroFlow2;case"ProtoGraph.Card.toCEEWParameter":return new ProtoGraph.Card.toCEEWParameter;case"ProtoGraph.Card.toCEEWPolicyDrillDown":return new ProtoGraph.Card.toCEEWPolicyDrillDown;case"ProtoGraph.Card.toDWChart":return new ProtoGraph.Card.toDWChart}}},{key:"renderCard",value:function(r){var t=this.getProtoInstance(r.git_repo_name),e={selector:document.querySelector("#protograph_edit_form_holder"),data_url:r.files.schema_files.sample+"?no-cache="+(new Date).toJSON(),schema_url:r.files.schema_files.schema+"?no-cache=true",configuration_url:r.files.configuration_sample+"?no-cache="+(new Date).toJSON(),configuration_schema_url:r.files.configuration_schema+"?no-cache=true"};r.files.ui_schema&&(e.ui_schema_url=r.files.ui_schema+"?no-cache=true"),r.files.base_url&&(e.base_url=r.files.base_url),window.site_config_url&&(e.site_config_url=window.site_config_url),"ProtoGraph.Card.toEducationDistrictMap"==r.git_repo_name&&(e.topo_url=r.files.base_url+"/india-district-topo.json"),["ProtoGraph.Card.toCEEWHeroFlow1","ProtoGraph.Card.toCEEWHeroFlow2","ProtoGraph.Card.toCEEWHero"].indexOf(r.git_repo_name)>=0&&(e.districts="https://cdn.protograph.pykih.com/Assets/districts.json",e.states="https://cdn.protograph.pykih.com/Assets/states.json"),t.init(e),this.setState({protoGraphInstance:t}),t.renderEdit(this.handlePublishClick)}},{key:"renderCardSelector",value:function(){var r=this,t=this.state.cards.map(function(t,e){return c.default.createElement("div",{key:e,className:"single-element",id:t.slug,onClick:r.handleSelectCardClick},c.default.createElement("div",{className:"card-type-icon","data-tooltip":t.account_slug+" / "+t.name,"data-position":"bottom center"},c.default.createElement("img",{src:t.icon_url})))});return c.default.createElement("div",{className:"ui main container"},c.default.createElement("h4",null," Select a card type "),c.default.createElement("div",{className:"protograph-toCardForm-cardsIconContainer"},t.length>=0&&t))}},{key:"renderCardWYSIWYG",value:function(){return c.default.createElement("div",{id:"protograph_edit_form_holder"},"Loading")}},{key:"render",value:function(){switch(this.state.currentStep){case 1:return this.renderCardSelector();case 2:return this.renderCardWYSIWYG()}}}]),t}(s.Component);t.default=p},function(r,t){r.exports=axios},function(r,t,e){"use strict";function o(r){return r&&r.__esModule?r:{default:r}}function a(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function n(r,t){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?r:t}function i(r,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(r,t):r.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var d=function(){function r(r,t){for(var e=0;e<t.length;e++){var o=t[e];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(r,o.key,o)}}return function(t,e,o){return e&&r(t.prototype,e),o&&r(t,o),t}}(),s=e(1),c=o(s),l=e(4),u=o(l),p=function(r){function t(r){a(this,t);var e=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,r));return e.state={currentStep:2,showSteps:!0,showUpdate:!0,updatedInstance:null},e.handlePublishClick=e.handlePublishClick.bind(e),e}return i(t,r),d(t,[{key:"componentDidMount",value:function(){var r=this,t=window.viewCast.template_card,e=document.createElement("script"),o=void 0;document.body.appendChild(e),e.onreadystatechange=e.onload=function(){if(!o){r.renderUpdateCard(t);var e=document.getElementById("protograph_image_bank_button");e&&(e.style.display="block")}o=!0},e.setAttribute("src",t.files.edit_file_js);var a=document.createElement("link");a.rel="stylesheet",a.href=t.files.css,document.head.appendChild(a)}},{key:"getProtoInstance",value:function(r){switch(r){case"ProtoGraph.Card.toSocial":return new ProtoGraph.Card.toSocial;case"ProtoGraph.Card.toExplain":return new ProtoGraph.Card.toExplain;case"ProtoGraph.Card.toQuiz":return new ProtoGraph.Card.toQuiz;case"ProtoGraph.Card.toReportViolence":return new ProtoGraph.Card.toReportViolence;case"ProtoGraph.Card.toLink":return new ProtoGraph.Card.toLink;case"ProtoGraph.Card.toTimeline":return new ProtoGraph.Card.toTimeline;case"ProtoGraph.Card.toAudioPhoto":return new ProtoGraph.Card.toAudioPhoto;case"ProtoGraph.Card.toReportJournalistKilling":return new ProtoGraph.Card.toReportJournalistKilling;case"ProtoGraph.Card.toDistrictProfile":return new ProtoGraph.Card.toDistrictProfile;case"ProtoGraph.Card.toRainfall":return new ProtoGraph.Card.toRainfall;case"ProtoGraph.Card.toWaterExploitation":return new ProtoGraph.Card.toWaterExploitation;case"ProtoGraph.Card.toLandUse":return new ProtoGraph.Card.toLandUse;case"ProtoGraph.Card.toWell":return new ProtoGraph.Card.toWell;case"ProtoGraph.Card.toPoliticalLeadership":return new ProtoGraph.Card.toPoliticalLeadership;case"ProtoGraph.Card.toMoveToANewCity":return new ProtoGraph.Card.toMoveToANewCity;case"ProtoGraph.Card.toCluster":return new ProtoGraph.Card.toCluster;case"ProtoGraph.Card.toQuestion":return new ProtoGraph.Card.toQuestion;case"ProtoGraph.Card.toCompanyProfile":return new ProtoGraph.Card.toCompanyProfile;case"ProtoGraph.Card.toStory":return new ProtoGraph.Card.toStory;case"ProtoGraph.Card.toMedia":return new ProtoGraph.Card.toMedia;case"ProtoGraph.Card.WaterExploitation":return new ProtoGraph.Card.WaterExploitation;case"ProtoGraph.Card.toGrid":return new ProtoGraph.Card.toGrid;case"ProtoGraph.Card.toSurveyScores":return new ProtoGraph.Card.toSurveyScores;case"ProtoGraph.Card.toStinkCoverVizCard":return new ProtoGraph.Card.toStinkCoverVizCard;case"ProtoGraph.Card.ComposeCard":return new ProtoGraph.Card.ComposeCard;case"ProtoGraph.Card.toImage":return new ProtoGraph.Card.toImage;case"ProtoGraph.Card.VideoYoutube":return new ProtoGraph.Card.toVideoYoutube;case"ProtoGraph.Card.toDataIRBFGrid":return new ProtoGraph.Card.toDataIRBFGrid;case"ProtoGraph.Card.toDataIRBFTooltip":return new ProtoGraph.Card.toDataIRBFTooltip;case"ProtoGraph.Card.toDataRatingWithDrillDown":return new ProtoGraph.Card.toDataRatingWithDrillDown;case"ProtoGraph.Card.toProfile":return new ProtoGraph.Card.toProfile;case"ProtoGraph.Card.toOrganCoverVizCard":return new ProtoGraph.Card.toOrganCoverVizCard;case"ProtoGraph.Card.toEducationDistrictMap":return new ProtoGraph.Card.toEducationDistrictMap;case"ProtoGraph.Card.HTMLCard":return new ProtoGraph.Card.HTMLCard;case"ProtoGraph.Card.toBio":return new ProtoGraph.Card.toBio;case"ProtoGraph.Card.toCEEWHero":return new ProtoGraph.Card.toCEEWHero;case"ProtoGraph.Card.toCEEWHeroFlow1":return new ProtoGraph.Card.toCEEWHeroFlow1;case"ProtoGraph.Card.toCEEWHeroFlow2":return new ProtoGraph.Card.toCEEWHeroFlow2;case"ProtoGraph.Card.toCEEWParameter":return new ProtoGraph.Card.toCEEWParameter;case"ProtoGraph.Card.toCEEWPolicyDrillDown":return new ProtoGraph.Card.toCEEWPolicyDrillDown;case"ProtoGraph.Card.toDWChart":return new ProtoGraph.Card.toDWChart}}},{key:"renderUpdateCard",value:function(r){var t=this.getProtoInstance(r.git_repo_name),e={selector:document.querySelector("#view_area"),data_url:window.viewCast.remote_urls.data_url+"?no-cache="+(new Date).toJSON(),schema_url:window.viewCast.remote_urls.schema_json+"?no-cache=true",configuration_url:window.viewCast.remote_urls.configuration_url+"?no-cache="+(new Date).toJSON(),configuration_schema_url:window.viewCast.template_card.files.configuration_schema+"?no-cache=true"};window.viewCast.template_card.files.ui_schema&&(e.ui_schema_url=window.viewCast.template_card.files.ui_schema+"?no-cache=true"),window.viewCast.template_card.files.base_url&&(e.base_url=window.viewCast.template_card.files.base_url),window.houseColors&&(e.houseColors=window.houseColors),window.site_config_url&&(e.site_config_url=window.site_config_url),"ProtoGraph.Card.toEducationDistrictMap"==r.git_repo_name&&(e.topo_url=r.files.base_url+"/india-district-topo.json"),["ProtoGraph.Card.toCEEWHeroFlow1","ProtoGraph.Card.toCEEWHeroFlow2","ProtoGraph.Card.toCEEWHero"].indexOf(r.git_repo_name)>=0&&(e.districts="https://cdn.protograph.pykih.com/Assets/districts.json",e.states="https://cdn.protograph.pykih.com/Assets/states.json"),t.init(e),this.setState({updatedInstance:t}),t.renderEdit(this.handlePublishClick)}},{key:"handlePublishClick",value:function(){var r=u.default.create({baseURL:window.baseURL}),t=this.state.updatedInstance.getData();return r.defaults.headers["Access-Token"]=window.accessToken,r.defaults.headers["Content-Type"]="application/json",r.put(window.baseURL+"/accounts/"+window.accountSlug+"/folders/"+window.folderSlug+"/datacasts/"+window.viewCast.id,{datacast:t.dataJSON,view_cast:{account_id:this.state.accountID,template_datum_id:this.state.templateDatumID,name:t.name,template_card_id:this.state.templateCardID,seo_blockquote:"function"==typeof this.state.updatedInstance.renderSEO?this.state.updatedInstance.renderSEO():"",optionalConfigJSON:JSON.stringify(t.optionalConfigJSON)}}).then(function(r){window.location.href=r.data.redirect_path}).catch(function(r){"undefined"!=typeof _errs&&_errs.push(r);var t=r.response.data.error_message;t?showAllValidationErrors(t):generate_notify({text:r.response.statusText,notify:"error"})})}},{key:"render",value:function(){return c.default.createElement("div",{className:"ui grid"},c.default.createElement("div",{className:"steps-area sixteen wide column"},c.default.createElement("div",{id:"view_area",className:"selected-card-preview"})))}}]),t}(s.Component);t.default=p}]);